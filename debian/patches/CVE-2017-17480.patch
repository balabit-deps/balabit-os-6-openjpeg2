Description: jp3d/jpwl convert: fix write stack buffer overflow
 Missing buffer length formatter in fscanf call might lead to write
 stack buffer overflow. Add missing formatters.
Author: Hugo Lefeuvre <hle@debian.org>
Origin: https://github.com/hlef/openjpeg/commit/0bc90e4062a5f9258c91eca018c019b179066c62
Bug-Debian: https://bugs.debian.org/884738
--- a/src/bin/jp3d/convert.c
+++ b/src/bin/jp3d/convert.c
@@ -281,7 +281,7 @@
 			fprintf(stdout, "[INFO] Loading %s \n",pgxfiles[pos]);
 
 			fseek(f, 0, SEEK_SET);
-			fscanf(f, "PG%[ \t]%c%c%[ \t+-]%d%[ \t]%d%[ \t]%d",temp,&endian1,&endian2,signtmp,&prec,temp,&w,temp,&h);
+			fscanf(f, "PG%31[ \t]%c%c%31[ \t+-]%d%31[ \t]%d%31[ \t]%d",temp,&endian1,&endian2,signtmp,&prec,temp,&w,temp,&h);
 
 			i=0;
 			sign='+';		
--- a/src/bin/jpwl/convert.c
+++ b/src/bin/jpwl/convert.c
@@ -1296,7 +1296,7 @@
 	}
 
 	fseek(f, 0, SEEK_SET);
-	if( fscanf(f, "PG%[ \t]%c%c%[ \t+-]%d%[ \t]%d%[ \t]%d",temp,&endian1,&endian2,signtmp,&prec,temp,&w,temp,&h) != 9){
+	if( fscanf(f, "PG%31[ \t]%c%c%31[ \t+-]%d%31[ \t]%d%31[ \t]%d",temp,&endian1,&endian2,signtmp,&prec,temp,&w,temp,&h) != 9){
 		fprintf(stderr, "ERROR: Failed to read the right number of element from the fscanf() function!\n");
 		return NULL;
 	}
